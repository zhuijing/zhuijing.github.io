(window.webpackJsonp=window.webpackJsonp||[]).push([[297],{694:function(a,s,t){"use strict";t.r(s);var e=t(10),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"loader-编写"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loader-编写"}},[a._v("#")]),a._v(" loader 编写")]),a._v(" "),s("h2",{attrs:{id:"loader是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loader是什么"}},[a._v("#")]),a._v(" loader是什么?")]),a._v(" "),s("ul",[s("li",[a._v("loader 用于对模块的源代码进行转换")]),a._v(" "),s("li",[a._v("loader 可以将文件从不同的语言（如 TypeScript）转换为 JavaScript 或将内联图像转换为 data URL。")]),a._v(" "),s("li",[a._v("loader 甚至允许你直接在 JavaScript 模块中 import CSS文件！")])]),a._v(" "),s("h2",{attrs:{id:"loader-特性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loader-特性"}},[a._v("#")]),a._v(" loader 特性")]),a._v(" "),s("ul",[s("li",[a._v("loader 从右到左（或从下到上）地取值(evaluate)/执行(execute)。")]),a._v(" "),s("li",[a._v("支持链式调用")]),a._v(" "),s("li",[a._v("loader 可以是同步的，也可以是异步的。")]),a._v(" "),s("li",[a._v("loader 运行在 Node.js 中，并且能够执行任何操作。")]),a._v(" "),s("li",[a._v("loader 可以通过 options 对象配置")]),a._v(" "),s("li",[a._v("loader 能够产生额外的任意文件")]),a._v(" "),s("li",[a._v("loader 遵循标准 "),s("a",{attrs:{href:"https://webpack.docschina.org/concepts/module-resolution/",target:"_blank",rel:"noopener noreferrer"}},[a._v("模块解析"),s("OutboundLink")],1),a._v(" 规则\n"),s("ul",[s("li",[s("p",[a._v("绝对路径（相对于本机的路径）- 由于已经获得文件的绝对路径，因此不需要再做进一步解析。")])]),a._v(" "),s("li",[s("p",[a._v("相对路径 (自己写的项目) - 使用 import 或 require 的资源文件所处的目录，被认为是上下文目录。在 import/require 中给定的相对路径，会拼接此上下文路径，来生成模块的绝对路径。")]),a._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("User"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("ReadingNotes"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("view"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("js 文件内容如下\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("import")]),a._v(" utils "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'../utils'")]),a._v("\n\n那么 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("User"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("ReadingNotes"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("view"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("会被认为是上下文路径，\n\n最终引用的utils文件路径是 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("User"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("ReadingNotes"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("utils"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("/")]),a._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("js\n\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://webpack.docschina.org/concepts/module-resolution/#module-paths",target:"_blank",rel:"noopener noreferrer"}},[a._v("模块路径"),s("OutboundLink")],1),a._v("（第三方Npm包）- 在 webpack.config.js 的 "),s("code",[a._v("resolve.modules")]),a._v(" 中指定的所有目录检索模块,默认是当前项目的 "),s("code",[a._v("node_modules")])])])])])]),a._v(" "),s("h2",{attrs:{id:"loader的使用方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#loader的使用方式"}},[a._v("#")]),a._v(" loader的使用方式")]),a._v(" "),s("h3",{attrs:{id:"配置方式-最常用方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置方式-最常用方式"}},[a._v("#")]),a._v(" 配置方式 （最常用方式）")]),a._v(" "),s("p",[a._v("在 webpack.config.js 文件中指定 loader,需要配置在"),s("code",[a._v("module.rules")]),a._v("内部，")]),a._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[a._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("module")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("rules")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("test")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token regex"}},[s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[a._v("/")]),s("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[a._v("\\.css$")]),s("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[a._v("/")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("use")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// [style-loader](/loaders/style-loader)")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'style-loader'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// [css-loader](/loaders/css-loader)")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'css-loader'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("options")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n              "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("modules")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// [sass-loader](/loaders/sass-loader)")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("loader")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'sass-loader'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br")])]),s("h3",{attrs:{id:"内联方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#内联方式"}},[a._v("#")]),a._v(" "),s("a",{attrs:{href:"https://webpack.docschina.org/concepts/loaders/#inline",target:"_blank",rel:"noopener noreferrer"}},[a._v("内联方式"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("不常用见官方文档")]),a._v(" "),s("h3",{attrs:{id:"cli-方式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cli-方式"}},[a._v("#")]),a._v(" "),s("a",{attrs:{href:"https://webpack.docschina.org/concepts/loaders/#cli",target:"_blank",rel:"noopener noreferrer"}},[a._v("CLI 方式"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("不常用见官方文档")]),a._v(" "),s("h2",{attrs:{id:"写个loader"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#写个loader"}},[a._v("#")]),a._v(" 写个Loader")]),a._v(" "),s("h3",{attrs:{id:"必备知识"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#必备知识"}},[a._v("#")]),a._v(" 必备知识")]),a._v(" "),s("ul",[s("li",[a._v("loader是一个导出函数的node 模块。当通过这个loader转换资源的时候会调用这个函数。这个函数将使用提供给它的this上下文访问Loader API。")]),a._v(" "),s("li",[a._v("调用loader处理资源的时候，只会传递一个资源文件的内容字符串作为参数。同步的loader可以只简单返回一个字符串表示转换后的值。")]),a._v(" "),s("li",[a._v("在更复杂的情况下，加载器可以使用this.callback（err，values ...）函数返回任意数量的值。")]),a._v(" "),s("li",[a._v("loader应返回一个或两个值。第一个值是作为字符串或缓冲区的结果JavaScript代码。The second optional value is a SourceMap as JavaScript object")]),a._v(" "),s("li",[a._v("最后一个loader,作为首个调用的的loader.它将被传递原始资源的内容")]),a._v(" "),s("li",[a._v("第一个loader,被最后调用。它应该返回一个JavaScript 和一个可选的  source map")]),a._v(" "),s("li",[a._v("中间的loader将用前一个loader的结果执行。")])]),a._v(" "),s("h3",{attrs:{id:"遵循规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#遵循规则"}},[a._v("#")]),a._v(" 遵循规则")]),a._v(" "),s("ul",[s("li",[a._v("loader要简洁")]),a._v(" "),s("li",[a._v("链式调用")]),a._v(" "),s("li",[a._v("模块化输出")]),a._v(" "),s("li",[a._v("确保它们是无状态的")]),a._v(" "),s("li",[a._v("使用 loader utilities")]),a._v(" "),s("li",[a._v("标记 "),s("a",{attrs:{href:"https://webpack.docschina.org/contribute/writing-a-loader/#loader-dependencies",target:"_blank",rel:"noopener noreferrer"}},[a._v("loader dependencies"),s("OutboundLink")],1)]),a._v(" "),s("li",[a._v("Resolve module dependencies")]),a._v(" "),s("li",[a._v("提取公共代码")]),a._v(" "),s("li",[a._v("避免绝对路径")]),a._v(" "),s("li",[a._v("使用 peerDependencies")])]),a._v(" "),s("h2",{attrs:{id:"文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文档"}},[a._v("#")]),a._v(" 文档")]),a._v(" "),s("ol",[s("li",[s("a",{attrs:{href:"https://webpack.docschina.org/api/loaders/",target:"_blank",rel:"noopener noreferrer"}},[a._v("loader Api"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://webpack.docschina.org/concepts/loaders/",target:"_blank",rel:"noopener noreferrer"}},[a._v("loader 概念"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/webpack/loader-utils",target:"_blank",rel:"noopener noreferrer"}},[a._v(" loader-utils "),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/webpack/schema-utils",target:"_blank",rel:"noopener noreferrer"}},[a._v("schema-utils"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);