# Dockerå®è·µ

## å¼€å§‹ä½¿ç”¨

### å¼€å¯docker
æ‰§è¡Œ `docker run -dp 80:80 docker/getting-started` è¿è¡Œä¸€ä¸ªå®¹å™¨

### Docker é¢æ¿
å¯è§†åŒ–Dockerç®¡ç†ï¼Œæ‰“å¼€è¯¥é¢æ¿å³å¯çœ‹åˆ°æˆ‘ä»¬åˆšå¯åŠ¨çš„å®¹å™¨

### ä»€ä¹ˆæ˜¯å®¹å™¨
å®¹å™¨åªæ˜¯è®¡ç®—æœºä¸Šçš„å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œå·²ä¸ä¸»æœºä¸Šçš„æ‰€æœ‰å…¶ä»–è¿›ç¨‹éš”ç¦»ã€‚è¿™ç§éš”ç¦»åˆ©ç”¨äº†Linuxä¸Šå·²æœ‰å¾ˆé•¿æ—¶é—´çš„å†…æ ¸åç§°ç©ºé—´å’Œcgroupã€‚

### ä»€ä¹ˆæ˜¯å®¹å™¨é•œåƒ
è¿è¡Œå®¹å™¨æ—¶ï¼Œå®ƒä½¿ç”¨éš”ç¦»çš„æ–‡ä»¶ç³»ç»Ÿã€‚æ­¤è‡ªå®šä¹‰æ–‡ä»¶ç³»ç»Ÿç”±å®¹å™¨æ˜ åƒæä¾›ã€‚ç”±äºæ˜ åƒåŒ…å«å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿï¼Œ
å› æ­¤å®ƒå¿…é¡»åŒ…å«è¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰å†…å®¹-æ‰€æœ‰ä¾èµ–é¡¹ï¼Œé…ç½®ï¼Œè„šæœ¬ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶ç­‰ã€‚
è¯¥æ˜ åƒè¿˜åŒ…å«å®¹å™¨çš„å…¶ä»–é…ç½®ï¼Œä¾‹å¦‚ç¯å¢ƒå˜é‡ï¼Œè¦è¿è¡Œçš„é»˜è®¤å‘½ä»¤å’Œå…¶ä»–å…ƒæ•°æ®ã€‚


## æˆ‘ä»¬çš„åº”ç”¨

### è·å– Appæºç 
[ç‚¹å‡»ä¸‹è½½](http://localhost/assets/app.zip)ï¼Œä¸‹è½½å®Œæˆåè§£å‹å¹¶æ‰“å¼€

### æ„å»ºAPP å®¹å™¨é•œåƒ

åœ¨ä¸Šä¸€æ­¥è·å–çš„æºç çš„`app`ç›®å½•é‡Œï¼Œæ–°å»º `Dockerfile`æ–‡ä»¶ï¼Œè¾“å…¥ä¸‹é¢å†…å®¹

```js
FROM node:12-alpine
WORKDIR /app
COPY . .
RUN yarn install --production
CMD ["node", "src/index.js"]
```

åˆ‡æ¢åˆ°`app`ç›®å½•ä¸‹ ï¼Œè¾“å…¥ä¸‹é¢å‘½ä»¤å¼€å§‹æ„å»ºé•œåƒ

`docker build -t getting-started .`

`-t` ç»™é•œåƒæ‰“ä¸Šæ ‡ç­¾ï¼Œ`.` ç¬¦å·ï¼Œè¡¨ç¤ºå»å½“å‰ç›®å½•æ‰¾Dockerfile

### å¼€å¯ä¸€ä¸ªAppå®¹å™¨
æ‰§è¡Œä¸‹é¢å‘½åå¼€å¯ä¸€ä¸ªå®¹å™¨ï¼Œç”¨æˆ‘ä»¬åˆšåˆšæ‰“çš„é•œåƒ`getting-started`

`docker run -dp 3000:3000 getting-started`

1. -d, åœ¨åå°è¿è¡Œ detached
2. -p 3000:3000 åœ¨ä¸»æœºçš„ç«¯å£3000åˆ°å®¹å™¨çš„ç«¯å£3000ä¹‹é—´åˆ›å»ºæ˜ å°„ã€‚

å½“æ§åˆ¶å°æˆåŠŸè¾“å‡ºå®¹å™¨idçš„æ—¶å€™ï¼Œæ‰“å¼€æµè§ˆå™¨http://localhost:3000/,å°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åº”ç”¨ã€‚


## æ›´æ–°å®¹å™¨

éœ€è¦æˆ‘ä»¬çš„åº”ç”¨åœ¨æ²¡æœ‰æ•°æ®çš„æ—¶å€™æç¤º `You have no todo items yet! Add one above!`
### æ›´æ–°ä»£ç 
                
1. æŠŠ `src/static/js/app.js` çš„56è¡Œ æ”¹ä¸º `<p className="text-center">No items yet! Add one above!</p>`
2. é‡æ–°æ„å»ºé•œåƒï¼Œ`docker build -t getting-started .`
3. å¯åŠ¨æ–°å®¹å™¨,`docker run -dp 3000:3000 getting-started`ï¼Œæ­¤æ—¶å‘ç°æŠ¥é”™
```js
docker: Error response from daemon: driver failed programming external connectivity on endpoint heuristic_greider (cea4c33d11e0f8f1ca148c145dd24b986fcfdaacf9e03957e58072522ee4bfbb): Bind for 0.0.0.0:3000 failed: port is already allocated.
```

### æ›¿æ¢æˆ‘ä»¬çš„æ—§å®¹å™¨
ç§»é™¤ä¸€ä¸ªå®¹å™¨ï¼Œéœ€è¦å…ˆæŠŠä»–åœæ­¢ï¼Œä¸€æ—¦å®¹å™¨è¢«åœæ­¢äº†ï¼Œä»–å°±å¯ä»¥è¢«ç§»é™¤äº†ã€‚æœ‰ä¸¤ç§ç§»é™¤æ–¹å¼ï¼š

1. ä½¿ç”¨Docker CLI ç§»é™¤
  - `docker ps` è·å–å®¹å™¨id
  - `docker stop <the-container-id>` åœæ­¢å®¹å™¨
  - `docker rm <the-container-id>` ç§»é™¤å®¹å™¨
  - `docker rm -f <the-container-id>` ä¸éœ€è¦åœæ­¢ï¼Œå¼ºåˆ¶åˆ é™¤

2. ä½¿ç”¨Dockerå¯è§†åŒ–å·¥å…·åˆ é™¤

### æ–°å»ºå®¹å™¨

åˆ é™¤æˆ‘ä»¬çš„æ—§å®¹å™¨åï¼Œæ‰§è¡Œ `docker run -dp 3000:3000 getting-started`æ–°å»ºå®¹å™¨ï¼Œåˆ·æ–° http://localhost:3000/


## åˆ†äº«å®¹å™¨
è¦å…±äº«å®¹å™¨ï¼Œéœ€è¦ä½¿ç”¨`Docker registry`,é»˜è®¤ä½¿ç”¨çš„æ˜¯[ Docker Hub ](https://hub.docker.com/)

### åˆ›å»ºä¸€ä¸ªä»“åº“

1. ç™»å½• Docker Hub 
2. ç‚¹å‡»Create Repository æŒ‰é’®
3. è¾“å…¥getting-started-xxxï¼Œæ¯”å¦‚æˆ‘è¾“å…¥äº† getting-started-czp
4. ç‚¹å‡»Create

### æ¨é€é•œåƒåˆ°è¿œç¨‹ä»“åº“

æ²¡æœ‰tag
1. docker login -u YOUR-USER-NAME. ç™»å½•Docker Hub
2. docker tag getting-started YOUR-USER-NAME/getting-started-czp. ã€docker tag æœ¬åœ°é•œåƒæº è¿œç¨‹é•œåƒä»“åº“ã€‘ã€‚ è¿œç¨‹æ²¡æœ‰çš„æ—¶å€™ä¼šè‡ªåŠ¨åˆ›å»º
3. docker push YOUR-USER-NAME/getting-started-czp

éœ€è¦tag
1. docker login -u YOUR-USER-NAME. ç™»å½•Docker Hub
2. docker tag getting-started YOUR-USER-NAME/getting-started-czp:test. 
3. docker push YOUR-USER-NAME/getting-started-czp:tset

### æµ‹è¯•æˆ‘ä»¬çš„é•œåƒ

1. [ç‚¹å‡»æ‰“å¼€æµ‹è¯•åœ°å€](https://labs.play-with-docker.com/)
2. ä½¿ç”¨ Docker Hub è´¦æˆ·ç™»å½•
3. ç‚¹å‡» ADD NEW INSTANCE
4. docker run -dp 3000:3000 YOUR-USER-NAME/getting-started-czp
5. ç‚¹å‡» 3000ç«¯å£å·ï¼Œå°±ä¼šæ‰“å¼€åˆšå¯åŠ¨çš„DockeræœåŠ¡ã€‚


## æ•°æ®æŒä¹…åŒ–

### å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿ 
å½“å®¹å™¨è¿è¡Œçš„æ—¶å€™ï¼Œå®ƒä½¿ç”¨é•œåƒä¸­çš„å„ä¸ªå±‚ä½œä¸ºå…¶æ–‡ä»¶ç³»ç»Ÿã€‚æ¯ä¸ªå®¹å™¨è¿˜æ‹¥æœ‰è‡ªå·±çš„â€œæš‚å­˜ç©ºé—´â€ä»¥åˆ›å»º/æ›´æ–°/åˆ é™¤æ–‡ä»¶ã€‚
å³ä½¿ä½¿ç”¨ç›¸åŒçš„é•œåƒï¼Œä¹Ÿä¸ä¼šåœ¨å…¶ä»–å®¹å™¨ä¸­çœ‹åˆ°ä»»ä½•æ›´æ”¹ã€‚

#### ç®€å•æ¡ˆä¾‹
1. æ‰§è¡Œ `docker run -d ubuntu bash -c "shuf -i 1-10000 -n 1 -o /data.txt && tail -f /dev/null"`

`shuf -i 1-10000 -n 1 -o /data.txt ` è¾“å‡ºä¸€ä¸ª 1-10000çš„éšæœºæ•°åˆ° data.txt

`tail -f /dev/null` è¿™ä¸ªå‘½ä»¤æ˜¯æŒç»­è¾“å‡ºï¼Œä¿æŒå®¹å™¨è¿è¡Œ

2. åœ¨ Docker å¯è§†åŒ–å·¥å…·ä¸­æ‰“å¼€åˆšåˆšå¯åŠ¨çš„ubuntuã€‚æ‰§è¡Œ`cat /data.txt`ï¼Œ å¯ä»¥çœ‹åˆ°`data.txt`çš„æ•°æ®

æˆ–è€…ç›´æ¥æ‰§è¡Œ `docker exec <container-id> cat /data.txt`ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°æ•°æ®

3. æˆ‘ä»¬å¼€å¯ä¸€ä¸ªæ–°çš„å®¹å™¨ `docker run -it ubuntu ls /`å¹¶æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿï¼Œæ­¤æ—¶æœªå‘ç°` data.txt`

4. ç§»é™¤ç¬¬ä¸€ä¸ªubuntu å®¹å™¨ ï¼Œ`docker rm -f 32031d768702`

### å®¹å™¨å· Container Volumes

1. åˆ›å»ºå®¹å™¨å·`docker volume create todo-db`
2. ç§»é™¤å­˜åœ¨çš„todo-listå®¹å™¨ `docker rm -f <id>`
3. å¼€å¯æ–°å®¹å™¨ï¼Œå¹¶åŠ å…¥`-v` å‚æ•°ï¼Œ `docker run -dp 3000:3000 -v todo-db:/etc/todos getting-started`
4. æ‰“å¼€`http://localhost:3000/`æ–°å¢å‡ ä¸ªtodo-item
5. ä½¿ç”¨ `docker ps`è·å–æ‰€æœ‰å®¹å™¨idï¼Œä½¿ç”¨ `docker rm -f <id>`åˆ é™¤å®¹å™¨
6. ä½¿ç”¨ç¬¬3æ¡å‘½ä»¤å†æ¬¡æ‰§è¡Œ

### æ·±å…¥æ¢è®¨
ä½¿ç”¨`docker volume inspect todo-db` æŸ¥çœ‹Dockerå®é™…ä¸Šå°†æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œ

```js
[
    {
        "CreatedAt": "2021-02-02T08:28:44Z",
        "Driver": "local",
        "Labels": {},
        "Mountpoint": "/var/lib/docker/volumes/todo-db/_data", ç£ç›˜ä¸Šå­˜å‚¨æ•°æ®çš„å®é™…ä½ç½®
        "Name": "todo-db",
        "Options": {},
        "Scope": "local"
    }
]

```

## ä½¿ç”¨ç»‘å®šå®‰è£…

ä½¿ç”¨ç»‘å®šå®‰è£…ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶ä¸»æœºä¸Šçš„ç¡®åˆ‡å®‰è£…ç‚¹ã€‚
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥ä¿ç•™æ•°æ®ï¼Œä½†é€šå¸¸ç”¨äºå‘å®¹å™¨ä¸­æä¾›å…¶ä»–æ•°æ®ã€‚
åœ¨å¤„ç†åº”ç”¨ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç»‘å®šæŒ‚è½½å°†æºä»£ç æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œä»¥ä½¿å…¶æŸ¥çœ‹ä»£ç æ›´æ”¹ï¼Œå“åº”å¹¶ç«‹å³æŸ¥çœ‹æ›´æ”¹ã€‚

### å¿«é€Ÿå·ç±»å‹æ¯”è¾ƒ
ç»‘å®šå®‰è£…å’Œå‘½åå·æ˜¯Dockerå¼•æ“éšé™„çš„ä¸¤ç§ä¸»è¦å·ç±»å‹ã€‚ä½†æ˜¯ï¼Œå¯ä»¥ä½¿ç”¨å…¶ä»–å·é©±åŠ¨ç¨‹åºæ¥æ”¯æŒå…¶ä»–ç”¨ä¾‹ï¼ˆSFTPï¼ŒCephï¼ŒNetAppï¼ŒS3ç­‰ï¼‰

### å¼€å§‹ä¸€ä¸ªå¼€å‘ç¯å¢ƒä¸‹çš„å®¹å™¨
1. æŠŠæºç æŒ‚è½½åœ¨å®¹å™¨é‡Œ
2. å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…æ‹¬å¼€å‘ä¾èµ–
3. å¯åŠ¨nodemon æ£€æµ‹æ–‡ä»¶æ”¹åŠ¨


å¼€å§‹é…ç½®ç¯å¢ƒ
1. æ‰§è¡Œä¸‹åˆ—ä»£ç 

```js
docker run -dp 3000:3000 \
    -w /app -v "$(pwd):/app" \
    node:12-alpine \
    sh -c "yarn install && yarn run dev"
```
  - -dp 3000:3000 åœ¨åå°æ¨¡å¼ä¸‹è¿è¡Œå¹¶åˆ›å»ºç«¯å£æ˜ å°„
  - -w /app è®¾ç½®å‘½ä»¤çš„â€œå·¥ä½œç›®å½•â€æˆ–å½“å‰ç›®å½•
  - -v "$(pwd):/app" ä»å®¹å™¨ä¸­çš„ä¸»æœºå°†å½“å‰ç›®å½•ç»‘å®šæŒ‚è½½åˆ°/ appç›®å½•ä¸­
  - node:12-alpine å’Œæˆ‘ä»¬Dockerfile é…ç½®çš„ ä¸€æ ·
  - sh -c "yarn install && yarn run dev" å®‰è£…å¼€å‘ä¾èµ–å¹¶å¯åŠ¨æœåŠ¡
2. æŸ¥çœ‹dockerè¾“å‡ºæ—¥å¿— `docker logs -f --tail=10  <container-id>`
3. ä¿®æ”¹ `src/static/js/app.js`æ–‡ä»¶çš„ ` {submitting ? 'Adding...' : 'Add Item'}` ä¸º` {submitting ? 'Adding...' : 'Add'}`
4. åˆ·æ–°æµè§ˆå™¨å¯ä»¥çœ‹åˆ°æŒ‰é’®å˜äº†ã€‚
5. é‡æ–°æ„å»ºé•œåƒ  `docker build -t getting-started .`


## å¤šå®¹å™¨è¿è¡Œ

å½“æˆ‘ä»¬ä½¿ç”¨node + mongodbå¼€å‘é¡¹ç›®çš„æ—¶å€™ï¼Œéœ€è¦ä¸¤ä¸ªå®¹å™¨æ¥è·‘åº”ç”¨ã€‚ç†ç”±å¦‚ä¸‹

1. æ•°æ®éš”ç¦»
2. å•ç‹¬çš„å®¹å™¨å¯è®©æ‚¨éš”ç¦»ç‰ˆæœ¬å’Œæ›´æ–°ç‰ˆæœ¬
3. æœ‰å¯èƒ½æœ¬åœ°å¼€å‘çš„æ—¶å€™éœ€è¦æœ¬åœ°ç‰ˆæœ¬ï¼ŒæœåŠ¡å™¨å¼€å‘çš„æ—¶å€™éœ€è¦æœåŠ¡å™¨ç‰ˆæœ¬ã€‚
4. è¿è¡Œå¤šä¸ªè¿›ç¨‹å°†éœ€è¦ä¸€ä¸ªè¿›ç¨‹ç®¡ç†å™¨ï¼ˆå®¹å™¨ä»…å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼‰ï¼Œè¿™å¢åŠ äº†å®¹å™¨å¯åŠ¨/å…³é—­çš„å¤æ‚æ€§

### å®¹å™¨ç½‘ç»œ

å®¹å™¨é—´é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œå¦‚æœä¸¤ä¸ªå®¹å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œï¼Œé‚£ä¹ˆä»–ä»¬èƒ½é€šä¿¡ï¼Œå¦åˆ™ä¸å¯ä»¥ã€‚

### å¼€å¯MySQL

1. åˆ›å»ºä¸€ä¸ªç½‘ç»œ `docker network create todo-app`
2. å¯åŠ¨ä¸€ä¸ªMySQLå®¹å™¨å¹¶å°†å…¶é™„åŠ åˆ°ç½‘ç»œ
```js
docker run -d \
    --network todo-app --network-alias mysql \
    -v todo-mysql-data:/var/lib/mysql \
    -e MYSQL_ROOT_PASSWORD=secret \
    -e MYSQL_DATABASE=todos \
    mysql:5.7
```
> æˆ‘ä»¬é€šè¿‡-v è¿æ¥äº†å·ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰é€šè¿‡ `docker volume create todo-mysql-data`åˆ›å»ºå·ã€‚å®é™…ä¸Šï¼Œå½“æˆ‘ä»¬è¿è¡Œå‘½ä»¤çš„æ—¶å€™
dockerå‘ç°æˆ‘ä»¬æ²¡æœ‰`todo-mysql-data`ï¼Œä»–ä¼šç»™æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªï¼Œå¹¶æŒ‚è½½ã€‚
3. ç¡®è®¤ä¸‹æˆ‘ä»¬çš„æ•°æ®åº“æ˜¯å¦è¿è¡Œ `docker exec -it <mysql-container-id> mysql -p`
  - è¾“å…¥å¯†ç  `secret`
  - ç™»å½•åè¾“å…¥ `SHOW DATABASES;`

### è¿æ¥åˆ°MySQL
ä½¿ç”¨  [nicolaka/netshoot](https://github.com/nicolaka/netshoot) å®¹å™¨ï¼Œè¿™ä¸ªå®¹å™¨æœ‰å¾ˆå¤šæœ‰ç”¨çš„ç½‘ç»œå·¥å…·

1. ä½¿ç”¨`nicolaka/netshoot`é•œåƒå¼€å¯ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œç¡®ä¿å®ƒè¿æ¥åœ¨åŒä¸€ä¸ªç½‘ç»œ
`docker run -it --network todo-app nicolaka/netshoot`
2. è¾“å…¥`dig mysql` ï¼Œè¾“å‡º

```

[1] ğŸ³  â†’ dig mysql

; <<>> DiG 9.14.12 <<>> mysql
;; global options: +cmd
;; Got answer:
;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 3399
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;mysql.				IN	A

;; ANSWER SECTION:
mysql.			600	IN	A	172.18.0.2

;; Query time: 2 msec
;; SERVER: 127.0.0.11#53(127.0.0.11)
;; WHEN: Tue Feb 02 10:27:24 UTC 2021
;; MSG SIZE  rcvd: 44

```

ANSWER SECTION: ä¸‹çš„172.18.0.2å°±æ˜¯æˆ‘ä»¬çš„å®¹å™¨é€šè®¯ipã€‚

è™½ç„¶mysqlä¸æ˜¯æœ‰æ•ˆçš„ä¸»æœºåï¼Œä½†æ˜¯DockerçŸ¥é“æ€ä¹ˆé€šè¿‡ä¸»æœºåè§£æåˆ°IPã€‚è¿™æ„å‘³ç€æˆ‘ä»¬è¦è¿æ¥åˆ°mysqlå®¹å™¨ï¼Œåªéœ€è¦çŸ¥é“åˆ«åå°±å¯ä»¥ã€‚



### æŠŠåº”ç”¨çš„æ•°æ®åº“è¿æ¥åˆ°Mysql

- MYSQL_HOST - the hostname for the running MySQL server
- MYSQL_USER - the username to use for the connection
- MYSQL_PASSWORD - the password to use for the connection
- MYSQL_DB - the database to use once connected

1. æ‰§è¡Œä¸‹æ¥æ“ä½œ
```js
docker run -dp 3000:3000 \
  -w /app -v "$(pwd):/app" \
  --network todo-app \
  -e MYSQL_HOST=mysql \
  -e MYSQL_USER=root \
  -e MYSQL_PASSWORD=secret \
  -e MYSQL_DB=todos \
  node:12-alpine \
  sh -c "yarn install && yarn run dev"
```

2. æŸ¥çœ‹åº”ç”¨æ—¥å¿—  `docker logs <container-id>`ï¼Œä¼šçœ‹åˆ° Connected to mysql db at host mysql

3. æ‰“å¼€http://localhost:3000/ï¼Œæ–°å¢å‡ ä¸ªtodo-item

4. æŸ¥çœ‹æ•°æ®åº“æ•°æ® `docker exec -it <mysql-container-id> mysql -p todos`

è¾“å…¥å¯†ç åï¼Œæ‰§è¡Œ `select * from todo_items;`å¯ä»¥çœ‹åˆ°æ‰“å°çš„æ•°æ®


## å®¹å™¨ç»„åˆ
1. åœ¨appç›®å½•ä¸‹æ–°å»º `docker-compose.yml`ï¼Œè¾“å…¥ä¸‹åˆ—å‘½ä»¤

```yml
version: "3.7"

services:
  app:
    image: node:12-alpine
    command: sh -c "yarn install && yarn run dev"
    ports:
      - 3000:3000
    working_dir: /app
    volumes:
      - ./:/app
    environment:
      MYSQL_HOST: mysql
      MYSQL_USER: root
      MYSQL_PASSWORD: secret
      MYSQL_DB: todos

  mysql:
    image: mysql:5.7
    volumes:
      - todo-mysql-data:/var/lib/mysql
    environment: 
      MYSQL_ROOT_PASSWORD: secret
      MYSQL_DATABASE: todos

volumes:
  todo-mysql-data:
```

2. åˆ é™¤æˆ‘ä»¬å‰é¢å¯åŠ¨çš„å®¹å™¨

3. æ‰§è¡Œ `docker-compose up -d`ï¼Œæ§åˆ¶å°æ‰“å°
```
Creating network "app_default" with the default driver
Creating volume "app_todo-mysql-data" with default driver
Creating app_app_1   ... done
Creating app_mysql_1 ... done
```
4. æ‰§è¡Œ `docker-compose logs -f app`å¯ä»¥æŸ¥çœ‹æ—¥å¿—

### Dockeré¢æ¿æ˜¾ç¤º

Dockeré¢æ¿å¯ä»¥çœ‹è§è¿è¡Œçš„appç»„ï¼Œè¿™ä¸ªåå­—é»˜è®¤æ˜¯docker-compose.ymlæ‰€åœ¨ç›®å½•çš„é¡¹ç›®åï¼Œå±•å¼€åå¯ä»¥çœ‹çœ‹è§

ä¸¤ä¸ªå­å®¹å™¨ï¼Œåå­—æ˜¯ä»¥ `project-name>_<service-name>_<replica-number>`ç»„æˆçš„ã€‚

### æ‹†å¼€ç»„

åœ¨appç›®å½•ä¸‹æ‰§è¡Œ `docker-compose down` ï¼Œæ‰€æœ‰å®¹å™¨å°†åœæ­¢ï¼Œç½‘ç»œè¢«ç§»é™¤ã€‚
ä½†æ˜¯volumesä¸ä¼šè¢«ç§»é™¤ï¼Œå¦‚æœéœ€è¦ç§»é™¤åˆ™åŠ ä¸Š --volumes


## æ„å»ºé•œåƒçš„æœ€ä½³å®è·µ

### [å®‰å…¨æ‰«æ](https://docs.docker.com/engine/scan/)
å½“æ„å»ºé•œåƒçš„æ—¶å€™ä½¿ç”¨`docker scan`å‘½ä»¤è¿›è¡Œæ¼æ´æ£€æµ‹ã€‚

ä¹Ÿå¯ä»¥åœ¨Docker Hubçš„é…ç½®ä¸­è®¾ç½®è‡ªåŠ¨æ‰«æã€‚

### é•œåƒåˆ†å±‚
1. å¯ä»¥ä½¿ç”¨ `docker image history <image-name>`æŸ¥çœ‹é•œåƒåˆ†å±‚ã€‚ä½¿ç”¨æ­¤åŠŸèƒ½ï¼Œæ‚¨è¿˜å¯ä»¥å¿«é€ŸæŸ¥çœ‹æ¯ä¸ªåˆ†å±‚çš„å¤§å°ï¼Œä»è€Œå¸®åŠ©è¯Šæ–­å¤§é•œåƒã€‚

2. ä½¿ç”¨ä¸Šé¢å‘½ä»¤çš„æ—¶å€™çœ‹è§æ•°æ®è¢«æŠ˜æ–­äº†ï¼Œå¯ä»¥ä½¿ç”¨ `docker image history --no-trunc getting-started`æ‰“å°å®Œæ•´çš„è¾“å‡ºã€‚

### åˆ†å±‚ç¼“å­˜

å›¾å±‚æ›´æ”¹åï¼Œæ‰€æœ‰ä¸‹æ¸¸å›¾å±‚ä¹Ÿå¿…é¡»é‡æ–°åˆ›å»º